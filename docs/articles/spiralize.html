<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Visualize Data on Spirals • spiralize</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Visualize Data on Spirals">
<meta property="og:description" content="spiralize">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spiralize</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/spiralize.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/annotate.html">Annotate the Plot</a>
    </li>
    <li>
      <a href="../articles/examples.html">Real World Examples</a>
    </li>
    <li>
      <a href="../articles/special_data_type.html">Initialize Spirals by Special Data Types</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/spiralize/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="spiralize_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Visualize Data on Spirals</h1>
                        <h4 class="author">Zuguang Gu (<a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a>)</h4>
            
            <h4 class="date">2021-06-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/spiralize/blob/master/vignettes/spiralize.Rmd"><code>vignettes/spiralize.Rmd</code></a></small>
      <div class="hidden name"><code>spiralize.Rmd</code></div>

    </div>

    
    
<p>In this vignette, I describe the package <strong>spiralize</strong> which visualizes data along an Archimedean spiral. It has two major advantages for visualization:</p>
<ol style="list-style-type: decimal">
<li>It is able to visualize data with very long axis with high resolution.</li>
<li>It is efficient for time series data to reveal periodic patterns.</li>
</ol>
<div id="the-archimedean-spiral" class="section level2">
<h2 class="hasAnchor">
<a href="#the-archimedean-spiral" class="anchor"></a>The Archimedean spiral</h2>
<p>In polar coordinates (<span class="math inline">\(r\)</span>, <span class="math inline">\(\theta\)</span>), the <a href="https://en.wikipedia.org/wiki/Archimedean_spiral">Archimedean spiral</a> has the following form:</p>
<p><span class="math display">\[ r = b \cdot \theta \]</span></p>
<p>where <span class="math inline">\(b\)</span> controls the distance between two loops. The radical distance between two neighbouring loops for a given <span class="math inline">\(\theta\)</span> is:</p>
<p><span class="math display">\[ d(\theta) = r(\theta + 2\pi) - r(\theta) = b \cdot (\theta + 2\pi) - b \cdot \theta = b \cdot 2\pi \]</span></p>
<p>This shows the radical distance between two neighbouring loops is independent to the value of <span class="math inline">\(\theta\)</span> and is a constant value. The following figure demonstrates an Archimedean spiral with 4 loops (<span class="math inline">\(\theta \in [0, 8\pi]\)</span>).</p>
<p><img src="spiralize_files/figure-html/unnamed-chunk-3-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Note <span class="math inline">\(\theta\)</span> can also be negative values where the spiral is mirrored by <em>y</em>-axis (in Cartesian coordinates). In <strong>spiralize</strong>, we only consider <span class="math inline">\(\theta\)</span> as positive values. The mirrored spiral can be set by the <code>flip</code> argument which is introduced later in this vignette.</p>
<p>Since the distance between any two neighbouring loops for any given <span class="math inline">\(\theta\)</span> is constant, it is a ideal place to put tracks along the spiral where the tracks have identical radical heights everywhere. Later the tracks can be served as virtual coordinate systems to map to data. This is why the package is called “<em>spiralize</em>” (to transform a normal Cartesian coordinate system to a curved spiral shape). The following two figures demonstrate a spiral with one track and with two tracks. The red line is the spiral itself. The spiral ranges between <span class="math inline">\(\pi/2\)</span> and <span class="math inline">\(6\pi\)</span>. It is easy to see the upper border of each track is also a spiral but with an offset <span class="math inline">\(a\)</span>:</p>
<p><span class="math display">\[ r = a + b \cdot \theta \]</span></p>
<p>where <span class="math inline">\(a\)</span> is the offset to the “Base spiral” (the red spiral in the following plots).</p>
<p><img src="spiralize_files/figure-html/unnamed-chunk-4-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Denote the maximal radius of the spiral as <span class="math inline">\(d_{max} = b \cdot \theta_{max}\)</span>, and denote the length of the spiral as <span class="math inline">\(l\)</span> (which has a complex form, see <a href="https://downloads.imagej.net/fiji/snapshots/arc_length.pdf" class="uri">https://downloads.imagej.net/fiji/snapshots/arc_length.pdf</a>), we can treat <span class="math inline">\(d_{max}\)</span> as the resolution of the visualization applied in the normal Cartesian coordinate system and <span class="math inline">\(l\)</span> as the resolution of the visualization applied on the spiral. Then the ratio of the two resolutions is:</p>
<p><span class="math display">\[ ratio = \frac{l}{2d_{max}} \]</span></p>
<p>E.g., for a spiral with 5 loops (<span class="math inline">\(\theta_{max} = 10\pi\)</span>), the ratio is 7.89, which means the spiral improves the resolution of visualization almost to 8 folds. Generally, the ratio increases almost linearly to the number of loops.</p>
<p><img src="spiralize_files/figure-html/unnamed-chunk-6-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="the-layout-of-the-spiral" class="section level2">
<h2 class="hasAnchor">
<a href="#the-layout-of-the-spiral" class="anchor"></a>The layout of the spiral</h2>
<p>The function <code><a href="../reference/spiral_initialize.html">spiral_initialize()</a></code> is used to intialize the spiral. Arguments <code>start</code> and <code>end</code> control the angular range of the spiral. Here the values should be in degrees and they are converted to radians internally.</p>
<p>In <strong>spiralize</strong>, the parameter <span class="math inline">\(b\)</span> in the spiral equation <span class="math inline">\(r = b \cdot \theta\)</span> is set to <span class="math inline">\(b = 1/2\pi\)</span>, so that the distance between two neighbouring loops is <span class="math inline">\(d = 1\)</span>. Denote <span class="math inline">\(\theta_e\)</span> as the end angle (in radians) of the spiral, the ranges of the viewport (under <strong>grid</strong> graphics system) on both <em>x</em>-axis and <em>y</em>-axis that draw the spiral are <span class="math inline">\([-x, x]\)</span> where</p>
<p><span class="math display">\[x = b \cdot \theta_e + d = 1/2\pi \cdot \theta_e + 1\]</span></p>
<p>The following two plots demonstrate different values of <code>start</code> and <code>end</code>. Also as shown in the following example code, I suggest to set the values of <code>start</code> and <code>end</code> in a form of <code>360*a + b</code>, e.g. <code>360*4 + 180</code>, so that it is straighforward to know the positions in the polar coordinates and how many loops there are in the spiral (I think people should feel more natural with degrees than radians).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the left plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>start <span class="op">=</span> <span class="fl">90</span>, end <span class="op">=</span> <span class="fl">360</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># the right plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>start <span class="op">=</span> <span class="fl">180</span>, end <span class="op">=</span> <span class="fl">360</span><span class="op">*</span><span class="fl">4</span> <span class="op">+</span> <span class="fl">180</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-8-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Argument <code>flip</code> controls how to flip the spiral. It accpets one of the four values: <code>"none"</code>/<code>"horizontal"</code>/<code>"vertical"</code>/<code>"both"</code>. Examples are as follows. In the examples, I additionally add the axes in the tracks to show in which direction the data extends along the spiral. I also manually adjust the height of the track to give enough space for axes.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the top left plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>flip <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="co"># default</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_axis.html">spiral_axis</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># the top right plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>flip <span class="op">=</span> <span class="st">"horizontal"</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_axis.html">spiral_axis</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># the bottom left plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>flip <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_axis.html">spiral_axis</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># the bottom right plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>flip <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_axis.html">spiral_axis</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-10-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Argument <code>scale_by</code> controls how to linearly scale the data on the spiral. It allows value of <code>"angle"</code> or <code>"curve_length"</code> (or for short, <code>"curve"</code>). <code>"angle"</code> means equal difference on data corresponds to equal difference of angles in the polar coordinates. <code>"curve_length"</code> means equal difference on data corresponds to euqal difference of the length of the spiral. Observe how the axis ticks distribute in the following two plots. Also the polar lines are removed for <code>scale_by = "curve_length"</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the left plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>scale_by <span class="op">=</span> <span class="st">"angle"</span><span class="op">)</span> <span class="co"># default</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_axis.html">spiral_axis</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># the right plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>scale_by <span class="op">=</span> <span class="st">"curve_length"</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_axis.html">spiral_axis</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-12-1.png" width="960" style="display: block; margin: auto;"></p>
<p>The following heatmaps might be clearer to demonstrate the difference between <code>"angle"</code> and <code>"curve_length"</code>. In this example, each grid has the equal bin size of the data.</p>
<p><img src="spiralize_files/figure-html/unnamed-chunk-13-1.png" width="960" style="display: block; margin: auto;"></p>
<p>As you can see, when <code>scale_by</code> is set to <code>"angle"</code>, in outer loops, even when the actually difference on data is the same, the physical widths are larger than these in inner loops. Nevertheless, when the data is time series or periodic, <code>"angle"</code> is the proper choice because it is easy to directly compare between loops which are the same time points over different periods. As a comparison, <code>"curve_length"</code> won’t provide any periodic information.</p>
<p>The spiral grows from inner loops to outer loops, thus, by default, data increases from the inner loops as well. This can be reversed by setting argument <code>reverse = TRUE</code>. See the following example and also observe the axes. The red arrows indicate the direction of axes.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the left plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># default</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_arrow.html">spiral_arrow</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.8</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_axis.html">spiral_axis</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># the right plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_arrow.html">spiral_arrow</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.8</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_axis.html">spiral_axis</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-15-1.png" width="960" style="display: block; margin: auto;"></p>
<p>To map data to spiral, argument <code>xlim</code> should be set which corresponds to data range on <em>x</em>-axis. Observe the axes in the following plots.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the left plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_axis.html">spiral_axis</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># the right plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_axis.html">spiral_axis</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-17-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="create-tracks" class="section level2">
<h2 class="hasAnchor">
<a href="#create-tracks" class="anchor"></a>Create tracks</h2>
<p>After the spiral is intialized, next we can add tracks along it. Argument <code>height</code> controls the height of the track. The value of <code>height</code> is a value between 0 and 1 which is the fraction of the distance between two neighbouring loops in the spiral. In the following left plot, I add black border to the track by setting the argument <code>background_gp</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the left plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">1</span>, background_gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># the right plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-19-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Multiple tracks can be added sequentially. Just note the sum of heights of all tracks should not exceed 1.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.4</span>, background_gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.2</span>, background_gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.1</span>, background_gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-20-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Data range on <em>y</em>-axis is specified by the argument <code>ylim</code>. In the following example, I also add a <em>y</em>-axis by <code><a href="../reference/spiral_yaxis.html">spiral_yaxis()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_yaxis.html">spiral_yaxis</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-21-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="graphics-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#graphics-functions" class="anchor"></a>Graphics functions</h2>
<p>Tracks are created with data ranges on both <em>x</em>-axis and <em>y</em>-axis. Now the tracks can be thought as normal Cartesian coordinates. There are following low-level graphics functions so that complex plots can be easily constructed by combining these low-level graphics functions.</p>
<div id="points" class="section level3">
<h3 class="hasAnchor">
<a href="#points" class="anchor"></a>Points</h3>
<p>Like other graphics functions e.g. <code><a href="https://rdrr.io/r/graphics/points.html">points()</a></code> or <code>grid.points()</code>, the “spiral graphics functions” also accept locations on <em>x</em>-axis and <em>y</em>-axis for data points. <code><a href="../reference/spiral_points.html">spiral_points()</a></code> draws points in the spiral track.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># by default xlim = c(0, 1)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>      <span class="co"># by default ylim = c(0, 1)</span>
<span class="fu"><a href="../reference/spiral_points.html">spiral_points</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-22-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="lines" class="section level3">
<h3 class="hasAnchor">
<a href="#lines" class="anchor"></a>Lines</h3>
<p>Adding lines with <code><a href="../reference/spiral_lines.html">spiral_lines()</a></code> is also straightforward:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span>
<span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_lines.html">spiral_lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-23-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Argument <code>type</code> can be set to <code>"h"</code> so that vertical lines (or radical lines if you take polar coordinates as reference) are drawn to the baseline for each data point.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the left plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_lines.html">spiral_lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, type <span class="op">=</span> <span class="st">"h"</span><span class="op">)</span>

<span class="co"># the right plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_lines.html">spiral_lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, type <span class="op">=</span> <span class="st">"h"</span>, baseline <span class="op">=</span> <span class="fl">0.5</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">y</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-25-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Argument <code>area</code> can be set to <code>TRUE</code> so that area under the lines can be filled with a certain color.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_lines.html">spiral_lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, area <span class="op">=</span> <span class="cn">TRUE</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-26-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Note you can also set <code>baseline</code> with <code>area = TRUE</code>, however, you cannot set different colors for the area above the baseline and below the baseline. Consider to use <code><a href="../reference/spiral_bars.html">spiral_bars()</a></code> or <code><a href="../reference/spiral_horizon.html">spiral_horizon()</a></code> for this scenario.</p>
</div>
<div id="segments" class="section level3">
<h3 class="hasAnchor">
<a href="#segments" class="anchor"></a>Segments</h3>
<p><code><a href="../reference/spiral_segments.html">spiral_segments()</a></code> draws a list of segments.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">=</span> <span class="fl">1000</span>
<span class="va">x0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">y0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">x1</span> <span class="op">=</span> <span class="va">x0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">0.01</span>, max <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>
<span class="va">y1</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">y0</span>

<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x0</span>, <span class="va">x1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_segments.html">spiral_segments</a></span><span class="op">(</span><span class="va">x0</span>, <span class="va">y0</span>, <span class="va">x1</span>, <span class="va">y1</span>, 
    gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>col <span class="op">=</span> <span class="fu">circlize</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/rand_color.html">rand_color</a></span><span class="op">(</span><span class="va">n</span>, luminosity <span class="op">=</span> <span class="st">"bright"</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0.5</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-27-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="rectangles" class="section level3">
<h3 class="hasAnchor">
<a href="#rectangles" class="anchor"></a>Rectangles</h3>
<p><code><a href="../reference/spiral_rect.html">spiral_rect()</a></code> draws rectangles, which is the base function for drawing heatmaps and barplots. The first four arguments are the coordinates of the bottom left and top right of the rectangles.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">=</span> <span class="fl">1000</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/circlize">circlize</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>

<span class="va">x1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">col1</span> <span class="op">=</span> <span class="fu">circlize</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_rect.html">spiral_rect</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="fl">0.5</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu">col1</span><span class="op">(</span><span class="va">x1</span><span class="op">)</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>

<span class="va">x2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">col2</span> <span class="op">=</span> <span class="fu">circlize</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_rect.html">spiral_rect</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu">col2</span><span class="op">(</span><span class="va">x2</span><span class="op">)</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-28-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="bars" class="section level3">
<h3 class="hasAnchor">
<a href="#bars" class="anchor"></a>Bars</h3>
<p><code><a href="../reference/spiral_bars.html">spiral_bars()</a></code> can draw bars simply from a numeric vector. Bars can also be drawn to a baseline.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1000</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.5</span>  <span class="co"># middle points of bars</span>
<span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>

<span class="co"># the left plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_bars.html">spiral_bars</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>

<span class="co"># the right plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_bars.html">spiral_bars</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, baseline <span class="op">=</span> <span class="fl">0.5</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">y</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-30-1.png" width="960" style="display: block; margin: auto;"></p>
<p><code><a href="../reference/spiral_bars.html">spiral_bars()</a></code> can also draw bars from a matrix, then each column in the matrix correspond to one stack of the bars.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">3</span><span class="op">*</span><span class="fl">1000</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">y</span> <span class="op">=</span> <span class="va">y</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_bars.html">spiral_bars</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-31-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="polygons" class="section level3">
<h3 class="hasAnchor">
<a href="#polygons" class="anchor"></a>Polygons</h3>
<p><code><a href="../reference/spiral_polygon.html">spiral_polygon()</a></code> draws polygons. Note the polygon must be closed, which means, the last data point should overlap to the first one.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">200</span><span class="op">)</span><span class="op">)</span>
<span class="va">x0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">x0</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">x1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">200</span><span class="op">)</span><span class="op">)</span>
<span class="va">x1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">x1</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">pt1</span> <span class="op">=</span> <span class="fu">circlize</span><span class="fu">:::</span><span class="fu">get_bezier_points</span><span class="op">(</span><span class="va">x0</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span>, <span class="fl">0</span>, <span class="va">x1</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
    <span class="va">pt2</span> <span class="op">=</span> <span class="fu">circlize</span><span class="fu">:::</span><span class="fu">get_bezier_points</span><span class="op">(</span><span class="va">x0</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">]</span>, <span class="fl">0</span>, <span class="va">x1</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">]</span>, <span class="fl">1</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>

    <span class="fu"><a href="../reference/spiral_polygon.html">spiral_polygon</a></span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x0</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">x0</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">pt2</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">pt1</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="va">x0</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">pt2</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">pt1</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>, 
        gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/rand_color.html">rand_color</a></span><span class="op">(</span><span class="fl">1</span>, luminosity <span class="op">=</span> <span class="st">"bright"</span><span class="op">)</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>
    <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-32-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="text" class="section level3">
<h3 class="hasAnchor">
<a href="#text" class="anchor"></a>Text</h3>
<p><code><a href="../reference/spiral_text.html">spiral_text()</a></code> draws texts. Argument <code>facing</code> controls the rotation of texts.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, length <span class="op">=</span> <span class="fl">26</span><span class="op">)</span>
<span class="va">text</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strrep.html">strrep</a></span><span class="op">(</span><span class="va">letters</span>, <span class="fl">6</span><span class="op">)</span>

<span class="co"># the top left plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.5</span>, <span class="va">text</span>, facing <span class="op">=</span> <span class="st">"downward"</span><span class="op">)</span> <span class="co"># default</span>

<span class="co"># the bottom left plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.5</span>, <span class="va">text</span>, facing <span class="op">=</span> <span class="st">"inside"</span><span class="op">)</span>

<span class="co"># the bottom right plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.5</span>, <span class="va">text</span>, facing <span class="op">=</span> <span class="st">"outside"</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-34-1.png" width="960" style="display: block; margin: auto;"></p>
<p>For long texts, <code>facing</code> can be set to <code>"curved_inside"</code> or <code>"curved_outside"</code> so that curved texts are draw along the spiral.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, length <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="va">text</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">letters</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span>

<span class="co"># the left plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.5</span>, <span class="va">text</span>, facing <span class="op">=</span> <span class="st">"curved_inside"</span><span class="op">)</span>

<span class="co"># the right plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.5</span>, <span class="va">text</span>, facing <span class="op">=</span> <span class="st">"curved_outside"</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-36-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Calculation of positions of letters of the curved text depends on the size of current graphics device. When the device changes its size, the positions of letters will not be correct and you need to regenerate the plot. Also users need to be careful when using <code>grid.grabExpr()</code> to capture the plot. By default <code>grid.grabExpr()</code> captures graphics output in a device with 7inch x 7inch. Users might need to manually set the device size to make sure the curved texts are not affected.</p>
<p>In the next example, I use <code>grid.grabExpr()</code> to capture two spiral plots with curved texts. Later the two plots are merged with using the <strong>cowplot</strong> package and the final merged plot is saved in a PDF with 10 inches width and 5 inches height. I manually set the device size in the two <code>grid.grabExpr()</code> calls so that the size of the place where the graphics are captured is the same as the size of the place where they are finally drawn.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">=</span> <span class="fu">grid.grabExpr</span><span class="op">(</span><span class="op">{</span>
    <span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
    <span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
    <span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.5</span>, <span class="va">text</span>, facing <span class="op">=</span> <span class="st">"curved_inside"</span><span class="op">)</span>
<span class="op">}</span>, width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">=</span> <span class="fu">grid.grabExpr</span><span class="op">(</span><span class="op">{</span>
    <span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
    <span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
    <span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.5</span>, <span class="va">text</span>, facing <span class="op">=</span> <span class="st">"curved_outside"</span><span class="op">)</span>
<span class="op">}</span>, width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span><span class="op">(</span><span class="va">...</span>, width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>one last thing for drawing text is that the argument <code>nice_facing</code> can be set to <code>TRUE</code> so that the rotation of texts are automatically adjusted so that they are easy to read, i.e. all the texts always face the lower part of the polar coordinate system.</p>
</div>
<div id="axis" class="section level3">
<h3 class="hasAnchor">
<a href="#axis" class="anchor"></a>Axis</h3>
<p><code>spiral_aixs()</code> draws axis along the spiral. So it is the <em>x</em>-axis of the data.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_axis.html">spiral_axis</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-38-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Argument <code>major_at</code> or simply <code>at</code> controls the break points on the axis and argument <code>labels</code> controls the corresponding axis labels.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the left plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">360</span><span class="op">*</span><span class="fl">4</span><span class="op">)</span>, start <span class="op">=</span> <span class="fl">360</span>, end <span class="op">=</span> <span class="fl">360</span><span class="op">*</span><span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_axis.html">spiral_axis</a></span><span class="op">(</span>major_at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">360</span><span class="op">*</span><span class="fl">4</span>, by <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">)</span>

<span class="co"># the right plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">12</span><span class="op">*</span><span class="fl">4</span><span class="op">)</span>, start <span class="op">=</span> <span class="fl">360</span>, end <span class="op">=</span> <span class="fl">360</span><span class="op">*</span><span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_axis.html">spiral_axis</a></span><span class="op">(</span>major_at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">12</span><span class="op">*</span><span class="fl">4</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">month.name</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-40-1.png" width="960" style="display: block; margin: auto;"></p>
<p>If the axis labels are too long, argument <code>curved_labels</code> can be set to <code>TRUE</code> so that the labels are curved along the spiral.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_axis.html">spiral_axis</a></span><span class="op">(</span>at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="fl">0.9</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strrep.html">strrep</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="fl">20</span><span class="op">)</span>, curved_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-41-1.png" width="480" style="display: block; margin: auto;"></p>
<p><code><a href="../reference/spiral_yaxis.html">spiral_yaxis()</a></code> draws <em>y</em>-axis. Argument <code>side</code> controls which side of the track to put the <em>y</em>-axis. <code>side</code> can be set to <code>"both"</code> so that <em>y</em>-axis is drawn on the two sides of the track.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the left plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_yaxis.html">spiral_yaxis</a></span><span class="op">(</span>side <span class="op">=</span> <span class="st">"start"</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_yaxis.html">spiral_yaxis</a></span><span class="op">(</span>side <span class="op">=</span> <span class="st">"end"</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1</span><span class="op">)</span>, labels <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>

<span class="co"># the right plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_yaxis.html">spiral_yaxis</a></span><span class="op">(</span>side <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-43-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="horizon-chart" class="section level3">
<h3 class="hasAnchor">
<a href="#horizon-chart" class="anchor"></a>Horizon chart</h3>
<p>Tracks along the spiral are long, but the heights of the tracks are normally very small. <a href="https://flowingdata.com/2015/07/02/changing-price-of-food-items-and-horizon-graphs/">Horizon chart</a> is an effcient way to visualize distributions by vertically folding the distribution graphics, which makes it possible to visualize in a plotting region with a very small height.</p>
<p>In the next example, I visualize difference of <strong>ggplot2</strong> daily downloads to the mean of the current year, between 2015-01-01 to 2020-12-31.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The data can be downloaded by the next line. The data object is already saved in spiralize package.</span>
<span class="co"># df = cranlogs::cran_downloads("ggplot2", from = "2015-01-01")</span>
<span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ggplot2_downloads.rds"</span>, package <span class="op">=</span> <span class="st">"spiralize"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># to simplify the data, I only take the complete years between 2015 and 2020</span>
<span class="va">df</span> <span class="op">=</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2021-01-01"</span><span class="op">)</span>, <span class="op">]</span>
<span class="va">day_diff</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">as.double</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">date</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">]</span> <span class="op">-</span> <span class="va">df</span><span class="op">$</span><span class="va">date</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"days"</span><span class="op">)</span>
<span class="va">year_mean</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">count</span>, <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">date</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>

<span class="va">df</span><span class="op">$</span><span class="va">diff</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">count</span><span class="op">/</span><span class="va">year_mean</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">date</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">diff</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html">is.infinite</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span>
<span class="va">q</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span>, <span class="fl">0.99</span><span class="op">)</span>  <span class="co"># adjust outliers</span>
<span class="va">df</span><span class="op">$</span><span class="va">diff</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">diff</span> <span class="op">&gt;</span> <span class="va">q</span><span class="op">]</span> <span class="op">=</span> <span class="va">q</span>
<span class="va">df</span><span class="op">$</span><span class="va">diff</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">diff</span> <span class="op">&lt;</span> <span class="op">-</span><span class="va">q</span><span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="va">q</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code></pre></div>
<pre><code>##         date count package       diff
## 1 2015-01-01   817 ggplot2 -1.4789475
## 2 2015-01-02  1218 ggplot2 -1.4789475
## 3 2015-01-03  1063 ggplot2 -1.4789475
## 4 2015-01-04  1106 ggplot2 -1.4789475
## 5 2015-01-05  2171 ggplot2 -1.1495651
## 6 2015-01-06  2455 ggplot2 -0.9722018</code></pre>
<p>Function <code><a href="../reference/spiral_horizon.html">spiral_horizon()</a></code> draws the horizon chart along the spiral. The input variables are <em>x</em>-locations and <em>y</em>-locations of the data. To align weeks at different years, each loop contains 364 (52 weeks). In the following plot, red areas correspond to those days when daily downloads are higher than the yearly average and blue areas correspond to the days when daily downloads are less than the yearly average.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, start <span class="op">=</span> <span class="fl">360</span>, end <span class="op">=</span> <span class="fl">360</span><span class="op">*</span><span class="op">(</span><span class="va">day_diff</span><span class="op">/</span><span class="fl">364</span><span class="op">)</span> <span class="op">+</span> <span class="fl">360</span><span class="op">)</span> <span class="co"># a circle of 52 weeks</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_horizon.html">spiral_horizon</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.5</span>, <span class="va">df</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-45-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Bars can be used to put on each days by setting argument <code>use_bar = TRUE</code>:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, start <span class="op">=</span> <span class="fl">360</span>, end <span class="op">=</span> <span class="fl">360</span><span class="op">*</span><span class="op">(</span><span class="va">day_diff</span><span class="op">/</span><span class="fl">364</span><span class="op">)</span> <span class="op">+</span> <span class="fl">360</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_horizon.html">spiral_horizon</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.5</span>, <span class="va">df</span><span class="op">$</span><span class="va">diff</span>, use_bars <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-46-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="images" class="section level3">
<h3 class="hasAnchor">
<a href="#images" class="anchor"></a>Images</h3>
<p><code><a href="../reference/spiral_raster.html">spiral_raster()</a></code> adds images to the spiral. Currently it supports formats of png/svg/pdf/eps/jpeg/jpg/tiff. The formats can be mixed used.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">image</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"Rlogo.png"</span>, package <span class="op">=</span> <span class="st">"circlize"</span><span class="op">)</span>
<span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, length <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>

<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_raster.html">spiral_raster</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.5</span>, <span class="va">image</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-47-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Similar as text, argument <code>facing</code> can be set to control the rotation of images. If <code>nice_facing = TRUE</code>, the image with rotation facing the top will be automatically adjusted to bottom.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the left plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_raster.html">spiral_raster</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.5</span>, <span class="va">image</span>, facing <span class="op">=</span> <span class="st">"inside"</span><span class="op">)</span>

<span class="co"># the right plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_raster.html">spiral_raster</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.5</span>, <span class="va">image</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, nice_facing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-49-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div id="arrows" class="section level3">
<h3 class="hasAnchor">
<a href="#arrows" class="anchor"></a>Arrows</h3>
<p><code><a href="../reference/spiral_arrow.html">spiral_arrow()</a></code> draws arrows along the spiral.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_arrow.html">spiral_arrow</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.6</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"red"</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_arrow.html">spiral_arrow</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.9</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>, tail <span class="op">=</span> <span class="st">"point"</span>, arrow_position <span class="op">=</span> <span class="st">"start"</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-50-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="highlight" class="section level3">
<h3 class="hasAnchor">
<a href="#highlight" class="anchor"></a>Highlight</h3>
<p><code><a href="../reference/spiral_highlight.html">spiral_highlight()</a></code> highlights a specific section of the spiral. If the argument <code>type</code> is set to <code>"rect"</code> (the default), it highlights the section with a semi-transparent rectangle which covers the complete range on <em>y</em>-axis. If <code>type</code> is set to <code>"line"</code>, an annotation line is drawn either at the bottom or on the top of the track.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_highlight.html">spiral_highlight</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_highlight.html">spiral_highlight</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span>, type <span class="op">=</span> <span class="st">"line"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_highlight.html">spiral_highlight</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.8</span>, type <span class="op">=</span> <span class="st">"line"</span>, line_side <span class="op">=</span> <span class="st">"outside"</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-51-1.png" width="480" style="display: block; margin: auto;"></p>
<p>If <code>scale_by</code> is set to <code>angle</code> (the default), users might also want to highlight a specific of interval but across several cycles, e.g. from January to March in year 2000 to 2010. Here the function <code><a href="../reference/spiral_highlight_by_sector.html">spiral_highlight_by_sector()</a></code> draws a semi-transparent sector to highlight a fixed interval over several cycles.</p>
<p>The first four argument <code>x1</code>, <code>x2</code>, <code>x3</code> and <code>x4</code> in <code><a href="../reference/spiral_highlight_by_sector.html">spiral_highlight_by_sector()</a></code> determine the position of the sector. If only <code>x1</code> and <code>x2</code> are specified, the start circle is calculated from <code>x1</code> and <code>x2</code> and the end circle is the most outside one. If <code>x3</code> and <code>x4</code> are also specified, the outer circle is calcualted from <code>x3</code> and <code>x4</code>.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">360</span><span class="op">*</span><span class="fl">4</span><span class="op">)</span>, start <span class="op">=</span> <span class="fl">360</span>, end <span class="op">=</span> <span class="fl">360</span><span class="op">*</span><span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_axis.html">spiral_axis</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_highlight_by_sector.html">spiral_highlight_by_sector</a></span><span class="op">(</span><span class="fl">36</span>, <span class="fl">72</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_highlight_by_sector.html">spiral_highlight_by_sector</a></span><span class="op">(</span><span class="fl">648</span>, <span class="fl">684</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_highlight_by_sector.html">spiral_highlight_by_sector</a></span><span class="op">(</span><span class="fl">216</span>, <span class="fl">252</span>, <span class="fl">936</span>, <span class="fl">972</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-52-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="dendrograms-and-phylogenetic-trees" class="section level3">
<h3 class="hasAnchor">
<a href="#dendrograms-and-phylogenetic-trees" class="anchor"></a>Dendrograms and phylogenetic trees</h3>
<p>When the dendrograms or phlogenetic trees have huge number of leaves, it is also suitable to use spiral to visualize them. There are two functions: <code><a href="../reference/spiral_dendrogram.html">spiral_dendrogram()</a></code> for <code>dendrogram</code> objects and <code><a href="../reference/spiral_phylo.html">spiral_phylo()</a></code> for <code>phylo</code> objects.</p>
<p>Note since dendrograms or phylogenetic trees do not have “periodic patterns”, <code>scale_by</code> in <code><a href="../reference/spiral_initialize.html">spiral_initialize()</a></code> is usually set to <code>"curve_length"</code>.</p>
<p>The <code>dendrogram</code> object can be rendered with <strong>dendextend</strong> package. See the following examples.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dend</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html">as.dendrogram</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># the left plot</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span><span class="op">)</span>, start <span class="op">=</span> <span class="fl">360</span>, end <span class="op">=</span> <span class="fl">360</span><span class="op">*</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">180</span>, scale_by <span class="op">=</span> <span class="st">"curve_length"</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_dendrogram.html">spiral_dendrogram</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span>

<span class="co"># the right plot</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://talgalili.github.io/dendextend/">dendextend</a></span><span class="op">)</span>
<span class="va">dend</span> <span class="op">=</span> <span class="fu"><a href="http://talgalili.github.io/dendextend/reference/color_branches.html">color_branches</a></span><span class="op">(</span><span class="va">dend</span>, k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span><span class="op">)</span>, start <span class="op">=</span> <span class="fl">360</span>, end <span class="op">=</span> <span class="fl">360</span><span class="op">*</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">180</span>, scale_by <span class="op">=</span> <span class="st">"curve_length"</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_dendrogram.html">spiral_dendrogram</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-54-1.png" width="960" style="display: block; margin: auto;"></p>
<p><code><a href="../reference/spiral_phylo.html">spiral_phylo()</a></code> works on the <code>phylo</code> object. In the following example, to cut the phylogenetic tree into several parts, the <code>phylo</code> object is converted to a <code>dendrogram</code> by the function <code><a href="../reference/phylo_to_dendrogram.html">phylo_to_dendrogram()</a></code>, later <code><a href="http://talgalili.github.io/dendextend/reference/cutree-methods.html">dendextend::cutree.dendrogram()</a></code> is applied to obtain the splits.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/">ape</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">hivtree.newick</span><span class="op">)</span>
<span class="va">tree.hiv</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html">read.tree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/textconnections.html">textConnection</a></span><span class="op">(</span><span class="va">hivtree.newick</span><span class="op">)</span><span class="op">)</span>
<span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">tree.hiv</span><span class="op">$</span><span class="va">tip.label</span><span class="op">)</span> <span class="co"># number of leaves</span>

<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">)</span>, start <span class="op">=</span> <span class="fl">360</span>, end <span class="op">=</span> <span class="fl">360</span><span class="op">*</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">180</span>, scale_by <span class="op">=</span> <span class="st">"curve_length"</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_phylo.html">spiral_phylo</a></span><span class="op">(</span><span class="va">tree.hiv</span><span class="op">)</span>

<span class="va">split</span> <span class="op">=</span> <span class="fu"><a href="http://talgalili.github.io/dendextend/reference/cutree-methods.html">cutree</a></span><span class="op">(</span><span class="fu"><a href="../reference/phylo_to_dendrogram.html">phylo_to_dendrogram</a></span><span class="op">(</span><span class="va">tree.hiv</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>
<span class="va">tb</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">split</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">tb</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="../reference/spiral_highlight.html">spiral_highlight</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">tb</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">i</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
        <span class="fu"><a href="../reference/spiral_highlight.html">spiral_highlight</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">tb</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">tb</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">i</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p><img src="spiralize_files/figure-html/unnamed-chunk-55-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="utility-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#utility-functions" class="anchor"></a>Utility functions</h2>
<p>There are several utility functions which help to get the information of current spiral plot. <code><a href="../reference/spiral_info.html">spiral_info()</a></code> prints the general information of current spiral:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_info.html">spiral_info</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## An Archimedean spiral (r = b*theta) with the following parameters:
##   b: 0.159154943091895
##   distance between two neighbouring circles: 1
##   xlim: [0, 100] 
##   range of theta (in degrees): [360, 1800]
##   The spiral curve is linearly scaled by angle.
## 
##   track 1:
##     ylim: [-1, 1]
##     height: 0.8 (fraction of the distance of two neighbour loops)</code></pre>
<p>The special variable <code>TRACK_META</code> retrieves several meta-information of the current track.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TRACK_META</span></code></pre></div>
<pre><code>## Please use in form of `TRACK_META$name`. Type `names(TRACK_META)` for supported names.</code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">TRACK_META</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "xlim"          "xmin"          "xmax"          "xcenter"       "xrange"        "theta_lim"    
##  [7] "theta_min"     "theta_max"     "theta_center"  "theta_range"   "ylim"          "ymin"         
## [13] "ymax"          "ycenter"       "yrange"        "radius_lim"    "radius_min"    "radius_max"   
## [19] "radius_center" "radius_range"  "abs_height"    "rel_height"    "track_index"</code></pre>
<p>The following two functions convert the data coordinates to polar coordinates or the canvas coordinates (the coordinates where the graphics are finally drawn).</p>
<ul>
<li><code><a href="../reference/xy_to_cartesian.html">xy_to_cartesian()</a></code></li>
<li><code><a href="../reference/xy_to_polar.html">xy_to_polar()</a></code></li>
</ul>
<p>The following three functions get or set the tracks:</p>
<ul>
<li><code><a href="../reference/current_track_index.html">current_track_index()</a></code></li>
<li><code><a href="../reference/set_current_track.html">set_current_track()</a></code></li>
<li><code>n_track()</code></li>
</ul>
</div>
<div id="session-info" class="section level2">
<h2 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session info</h2>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R version 4.1.0 (2021-05-18)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur 10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] C/UTF-8/C/C/C/C
## 
## attached base packages:
## [1] grid      stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] ape_5.5           dendextend_1.15.1 circlize_0.4.12   GetoptLong_1.0.5  cowplot_1.1.1    
## [6] spiralize_0.99.0  knitr_1.33       
## 
## loaded via a namespace (and not attached):
##  [1] viridis_0.6.1        sass_0.4.0           jsonlite_1.7.2       viridisLite_0.4.0   
##  [5] foreach_1.5.1        bslib_0.2.5.1        assertthat_0.2.1     highr_0.9           
##  [9] stats4_4.1.0         yaml_2.2.1           pillar_1.6.1         lattice_0.20-44     
## [13] glue_1.4.2           digest_0.6.27        RColorBrewer_1.1-2   colorspace_2.0-1    
## [17] htmltools_0.5.1.1    pkgconfig_2.0.3      purrr_0.3.4          scales_1.1.1        
## [21] tibble_3.1.2         generics_0.1.0       IRanges_2.26.0       ggplot2_3.3.3       
## [25] ellipsis_0.3.2       cachem_1.0.5         BiocGenerics_0.38.0  magrittr_2.0.1      
## [29] crayon_1.4.1         memoise_2.0.0        evaluate_0.14        fs_1.5.0            
## [33] fansi_0.5.0          doParallel_1.0.16    nlme_3.1-152         Cairo_1.5-12.2      
## [37] textshaping_0.3.5    tools_4.1.0          GlobalOptions_0.1.2  lifecycle_1.0.0     
## [41] matrixStats_0.59.0   ComplexHeatmap_2.8.0 stringr_1.4.0        S4Vectors_0.30.0    
## [45] munsell_0.5.0        cluster_2.1.2        bezier_1.1.2         compiler_4.1.0      
## [49] pkgdown_1.6.1        jquerylib_0.1.4      systemfonts_1.0.2    rlang_0.4.11        
## [53] iterators_1.0.13     rjson_0.2.20         rmarkdown_2.8        gtable_0.3.0        
## [57] codetools_0.2-18     DBI_1.1.1            R6_2.5.0             gridExtra_2.3       
## [61] lubridate_1.7.10     dplyr_1.0.6          fastmap_1.1.0        utf8_1.2.1          
## [65] clue_0.3-59          rprojroot_2.0.2      ragg_1.1.3           shape_1.4.6         
## [69] desc_1.3.0           stringi_1.6.2        parallel_4.1.0       Rcpp_1.0.6          
## [73] vctrs_0.3.8          png_0.1-7            tidyselect_1.1.1     xfun_0.23</code></pre>
<script src="jquery.min.js"></script><script src="jquery.sticky.js"></script><script>
$(document).ready(function(){
    $("#TOC").sticky({
        topSpacing: 0,
        zIndex:1000    
    })
    $("#TOC").on("sticky-start", function() {

        $("<p style='font-size:1.2em; padding-left:4px;'><a id='TOC-click'>Table of Content</a></p>").insertBefore($("#TOC ul:first-child"));
        $("#TOC-click").hover(function() {
            $(this).css("color", "#0033dd").css("cursor", "pointer");
            $("#TOC").children().first().next().show();
            $("#TOC").hover(function() {
                $(this).children().first().next().show();
            }, function() {
                $(this).children().first().next().hide();
                $("body").off("hover", "#TOC");
            })
        }, function() {
            $(this).css("color", "#0033dd");
        })
        $("#TOC").children().first().next().hide();

    })
    $("#TOC").on("sticky-end", function() {
        $("#TOC").children().first().remove();
        $("#TOC").children().first().show();
    })
});
</script>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
