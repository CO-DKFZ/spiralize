<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Real World Examples • spiralize</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Real World Examples">
<meta property="og:description" content="spiralize">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spiralize</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/spiralize.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/annotate.html">Annotate the Plot</a>
    </li>
    <li>
      <a href="../articles/examples.html">Real World Examples</a>
    </li>
    <li>
      <a href="../articles/special_data_type.html">Initialize Spirals by Special Data Types</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/spiralize/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="examples_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Real World Examples</h1>
                        <h4 class="author">Zuguang Gu (<a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a>)</h4>
            
            <h4 class="date">2021-06-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/spiralize/blob/master/vignettes/examples.Rmd"><code>vignettes/examples.Rmd</code></a></small>
      <div class="hidden name"><code>examples.Rmd</code></div>

    </div>

    
    
<div id="daily-downloads-of-ggplot2" class="section level2">
<h2 class="hasAnchor">
<a href="#daily-downloads-of-ggplot2" class="anchor"></a>Daily downloads of ggplot2</h2>
<p>In previous vignettes, I have already demonstrated the visualization of daily downloads of <strong>ggplot</strong> package. Here I make a more complete plot where I also add text annotations and legends. As I mentioned in previous vignettes, the plot visualizes log2-difference of the daily downloads to the mean downloads of the current year, which is calculated as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/spiralize">spiralize</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/ComplexHeatmap">ComplexHeatmap</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/circlize">circlize</a></span><span class="op">)</span>

<span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ggplot2_downloads.rds"</span>, package <span class="op">=</span> <span class="st">"spiralize"</span><span class="op">)</span><span class="op">)</span>
<span class="va">day_diff</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">as.double</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">date</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">]</span> <span class="op">-</span> <span class="va">df</span><span class="op">$</span><span class="va">date</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"days"</span><span class="op">)</span>
<span class="va">year_mean</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">count</span>, <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">date</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>

<span class="va">df</span><span class="op">$</span><span class="va">diff</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">count</span><span class="op">/</span><span class="va">year_mean</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">date</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">diff</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html">is.infinite</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span>
<span class="va">q</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span>, <span class="fl">0.99</span><span class="op">)</span>  <span class="co"># adjust outliers</span>
<span class="va">df</span><span class="op">$</span><span class="va">diff</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">diff</span> <span class="op">&gt;</span> <span class="va">q</span><span class="op">]</span> <span class="op">=</span> <span class="va">q</span>
<span class="va">df</span><span class="op">$</span><span class="va">diff</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">diff</span> <span class="op">&lt;</span> <span class="op">-</span><span class="va">q</span><span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="va">q</span></code></pre></div>
<p>The downloads have weekly patterns, i.e. there are less downloads in the weekends, thus in the spiral plot, I set the period as 52 weeks so that the same week in different years can be aligned in the radical direction. Now since each loop does not correspond a complete year, I additionally add annotation lines to show years.</p>
<p>The polar coordiante system is split into 12 parts where each part corresponds to a month.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spiral_initialize_by_time.html">spiral_initialize_by_time</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, padding <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">2</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## 'unit_to_axis' is set to 'days'.
## 'period' is set to 'years'.</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_horizon.html">spiral_horizon</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">date</span>, <span class="va">df</span><span class="op">$</span><span class="va">diff</span>, use_bars <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="../reference/spiral_highlight.html">spiral_highlight</a></span><span class="op">(</span><span class="st">"start"</span>,      <span class="st">"2015-12-31"</span>, type <span class="op">=</span> <span class="st">"line"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_highlight.html">spiral_highlight</a></span><span class="op">(</span><span class="st">"2016-01-01"</span>, <span class="st">"2016-12-31"</span>, type <span class="op">=</span> <span class="st">"line"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>col <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_highlight.html">spiral_highlight</a></span><span class="op">(</span><span class="st">"2017-01-01"</span>, <span class="st">"2017-12-31"</span>, type <span class="op">=</span> <span class="st">"line"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>col <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_highlight.html">spiral_highlight</a></span><span class="op">(</span><span class="st">"2018-01-01"</span>, <span class="st">"2018-12-31"</span>, type <span class="op">=</span> <span class="st">"line"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>col <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_highlight.html">spiral_highlight</a></span><span class="op">(</span><span class="st">"2019-01-01"</span>, <span class="st">"2019-12-31"</span>, type <span class="op">=</span> <span class="st">"line"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>col <span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_highlight.html">spiral_highlight</a></span><span class="op">(</span><span class="st">"2020-01-01"</span>, <span class="st">"2020-12-31"</span>, type <span class="op">=</span> <span class="st">"line"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>col <span class="op">=</span> <span class="fl">7</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_highlight.html">spiral_highlight</a></span><span class="op">(</span><span class="st">"2021-01-01"</span>, <span class="st">"end"</span>,        type <span class="op">=</span> <span class="st">"line"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>col <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span>

<span class="va">s</span> <span class="op">=</span> <span class="fu"><a href="../reference/current_spiral.html">current_spiral</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">360</span>, by <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">%%</span> <span class="fl">360</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">foo</span> <span class="op">=</span> <span class="fu"><a href="../reference/polar_to_cartesian.html">polar_to_cartesian</a></span><span class="op">(</span><span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">/</span><span class="fl">180</span><span class="op">*</span><span class="va">pi</span>, <span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">max_radius</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">1.05</span><span class="op">)</span>
    <span class="fu">grid.text</span><span class="op">(</span><span class="va">month.name</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, x <span class="op">=</span> <span class="va">foo</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">foo</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span>, default.unit <span class="op">=</span> <span class="st">"native"</span>,
        rot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">180</span>, <span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="fl">90</span>, <span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">90</span><span class="op">)</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">lgd</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/packLegend.html">packLegend</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Legend.html">Legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Difference to\nyearly average"</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"higher"</span>, <span class="st">"lower"</span><span class="op">)</span>,
        legend_gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#D73027"</span>, <span class="st">"#313695"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Legend.html">Legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Year"</span>, type <span class="op">=</span> <span class="st">"lines"</span>, at <span class="op">=</span> <span class="fl">2015</span><span class="op">:</span><span class="fl">2021</span>,
        legend_gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>col <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html">draw</a></span><span class="op">(</span><span class="va">lgd</span>, x <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">1</span>, <span class="st">"npc"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">10</span>, <span class="st">"mm"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-3-1.png" width="960" style="display: block; margin: auto;"></p>
<p>In the plot, I think there are the following messages that we can read:</p>
<ol style="list-style-type: decimal">
<li>There are less downloads at weekends compared to weekdays.</li>
<li>There are less downloads at the end of December and in Juanuary and Feburary.</li>
<li>The downloads are also less in July and August, but not as few as winters.</li>
<li>There are the highest number of downloads in November.</li>
</ol>
</div>
<div id="classification-of-central-nervous-system-tumors" class="section level2">
<h2 class="hasAnchor">
<a href="#classification-of-central-nervous-system-tumors" class="anchor"></a>Classification of central nervous system tumors</h2>
<p><a href="https://www.nature.com/articles/nature26000">Capper et. al., 2018</a> studied subtype classification of central nervous system tumors from DNA methylation data. In their dataset, there are 14 different tumor types (include controls) which are classified into 91 subtypes inferred from 2801 samples.</p>
<p>The most straightforward way is to visualize it as a heatmap which is composed by a list of rectangles.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"CNS_tumour_classification.rds"</span>, package <span class="op">=</span> <span class="st">"spiralize"</span><span class="op">)</span><span class="op">)</span>
<span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">)</span>, scale_by <span class="op">=</span> <span class="st">"curve_length"</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_rect.html">spiral_rect</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">meth_col</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_rect.html">spiral_rect</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">tumor_col</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>

<span class="va">r1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rle.html">rle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">tumor_type</span><span class="op">)</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">0.5</span>, <span class="va">r1</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, facing <span class="op">=</span> <span class="st">"curved_inside"</span>, nice_facing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
        <span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">0.5</span>, <span class="va">r1</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, 
            facing <span class="op">=</span> <span class="st">"curved_inside"</span>, nice_facing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
    <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The plot already looks good. However, one problem of that plot is I actually drawed 2801x2 rectangles, which might results in that you can observe “interference wave lines” in the plot. This is because rectangles on spirals are not real rectangles while polygons and edges of the neighbouring polygons cannot perfectly match.</p>
<p>In the previous code where I draw the text of tumor types, I used <code><a href="https://rdrr.io/r/base/rle.html">rle()</a></code> function to group the tumor types. Actually we can also use it for the heatmap because tumor types and methylation classes are already sorted and grouped, so that we don’t need to draw every single rectangle for every sample in a class, which we just draw one rectangle that covers all samples in that class.</p>
<p>In the following code, I first define a function <code>spiral_rle()</code> for this purpose. This function draws rectangles and adds labels on them.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">spiral_rle</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">col</span>, <span class="va">labels</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># in case it is a factor</span>
    <span class="va">r1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rle.html">rle</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
    <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
        <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
            <span class="fu"><a href="../reference/spiral_rect.html">spiral_rect</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="va">r1</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
            <span class="fu"><a href="../reference/spiral_rect.html">spiral_rect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="va">r1</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
        <span class="op">}</span>
    <span class="op">}</span>

    <span class="kw">if</span><span class="op">(</span><span class="va">labels</span><span class="op">)</span> <span class="op">{</span>
        <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
            <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span>
                <span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">0.5</span>, <span class="va">r1</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, facing <span class="op">=</span> <span class="st">"curved_inside"</span>, nice_facing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
            <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
                <span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">0.5</span>, <span class="va">r1</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, 
                    facing <span class="op">=</span> <span class="st">"curved_inside"</span>, nice_facing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
            <span class="op">}</span>
        <span class="op">}</span>
    <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p>I apply <code>spiral_rle()</code> to both tumor type track and methylation class track. Now the plot looks nicer. I also add legends for methylation classes, grouped by tumor types.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">)</span>, scale_by <span class="op">=</span> <span class="st">"curve_length"</span>, 
    vp_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">0</span>, <span class="st">"npc"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>
<span class="va">meth_col</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html">structure</a></span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">meth_class</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">meth_col</span><span class="op">)</span><span class="op">)</span>
<span class="fu">spiral_rle</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">meth_class</span>, col <span class="op">=</span> <span class="va">meth_col</span><span class="op">)</span>

<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>
<span class="va">tumor_col</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html">structure</a></span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">tumor_type</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">tumor_col</span><span class="op">)</span><span class="op">)</span>
<span class="fu">spiral_rle</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">tumor_type</span>, col <span class="op">=</span> <span class="va">tumor_col</span>, labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">lgd_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, <span class="va">df</span><span class="op">$</span><span class="va">tumor_type</span>, <span class="kw">function</span><span class="op">(</span><span class="va">ind</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Legend.html">Legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">tumor_type</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">meth_class</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span><span class="op">)</span>,
        legend_gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">meth_col</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>

<span class="co"># here set max_height to the height of the image so that the legends are automatically arranged</span>
<span class="va">lgd</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/packLegend.html">packLegend</a></span><span class="op">(</span>list <span class="op">=</span> <span class="va">lgd_list</span>, max_height <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">7</span>, <span class="st">"inch"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html">draw</a></span><span class="op">(</span><span class="va">lgd</span>, x <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">1</span>, <span class="st">"npc"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-6-1.png" width="1248" style="display: block; margin: auto;"></p>
</div>
<div id="first-5000-digits-of-π" class="section level2">
<h2 class="hasAnchor">
<a href="#first-5000-digits-of-%CF%80" class="anchor"></a>First 5000 digits of π</h2>
<p>This example visualizes the first 5000 digits of π. The digits of π is from <a href="https://www.math.utah.edu/~alfeld/math/pi.html" class="uri">https://www.math.utah.edu/~alfeld/math/pi.html</a>.</p>
<p>The following code first format the π digits as a vector of integers.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pi_txt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"pi_10000_digits.txt"</span>, package <span class="op">=</span> <span class="st">"spiralize"</span><span class="op">)</span><span class="op">)</span>
<span class="va">pi_txt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"\\s"</span>, <span class="st">""</span>, <span class="va">pi_txt</span><span class="op">)</span>
<span class="va">pi_digits</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">pi_txt</span>, <span class="st">""</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span>
<span class="va">pi_digits</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">pi_digits</span><span class="op">)</span>
<span class="va">pi_digits</span> <span class="op">=</span> <span class="va">pi_digits</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5000</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pi_digits</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1 4 1 5 9 2</code></pre>
<p>Then each digit is assigned to a color and the point size changes according to the value of the corresponding digit.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># There are 30 loops in the spiral</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5000</span><span class="op">)</span>, end <span class="op">=</span> <span class="fl">365</span><span class="op">*</span><span class="fl">30</span>, scale_by <span class="op">=</span> <span class="st">"curve"</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">1</span>, background <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_points.html">spiral_points</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5000</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, pch <span class="op">=</span> <span class="fl">16</span>, size <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="op">(</span><span class="va">pi_digits</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">5</span>, <span class="st">"mm"</span><span class="op">)</span>, 
    gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>col <span class="op">=</span> <span class="va">pi_digits</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The next plot shows another way to visualize π. In the plot, two neighbour digits of 1 are connected, e.g. a segment connects the first and the second 1, then a second segment connects the third and the fourth 1, and so on. The segments are assigned with random colors.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5000</span><span class="op">)</span>, end <span class="op">=</span> <span class="fl">365</span><span class="op">*</span><span class="fl">30</span>, scale_by <span class="op">=</span> <span class="st">"curve"</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">1</span>, background <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">pi_digits</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>
<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">%%</span> <span class="fl">2</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="va">x</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>
<span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="va">x1</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span>
<span class="va">x2</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span><span class="op">]</span>

<span class="fu"><a href="../reference/spiral_segments.html">spiral_segments</a></span><span class="op">(</span><span class="va">x1</span> <span class="op">-</span> <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="va">x2</span> <span class="op">-</span> <span class="fl">0.5</span>, <span class="fl">0.5</span>, 
    gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/rand_color.html">rand_color</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span>, min <span class="op">=</span> <span class="fl">0.5</span>, max <span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="tree-of-life" class="section level2">
<h2 class="hasAnchor">
<a href="#tree-of-life" class="anchor"></a>Tree of life</h2>
<p>This example visualizes tree of life from 3083 organisms. The data is from <a href="https://www.nature.com/articles/nmicrobiol201648">Hug et. al., 2016</a>, supplementary data 2.</p>
<p>To highlight different branches, I first convert the <code>phylo</code> object into a <code>dendrogram</code> object, then apply <code><a href="http://talgalili.github.io/dendextend/reference/cutree-methods.html">dendextend::cutree()</a></code> to split the dendrogram into several subtrees. Note the function <code>spiral_rel()</code> was defined in the the example <a href="#classification-of-central-nervous-system-tumors">“Classification of central nervous system tumors”</a>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># https://www.nature.com/articles/nmicrobiol201648</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/">ape</a></span><span class="op">)</span>
<span class="va">tree</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"life_tree_Nat_Microbiol_2016.rds"</span>, package <span class="op">=</span> <span class="st">"spiralize"</span><span class="op">)</span><span class="op">)</span>
<span class="va">tree</span></code></pre></div>
<pre><code>## 
## Phylogenetic tree with 3083 tips and 3081 internal nodes.
## 
## Tip labels:
##   Bacteria_Proteobacteria_Gammaproteobacteria_Enterobacteriales_Enterobacteriaceae_Lelliottia_amnigena_CHS_78, Bacteria_Proteobacteria_Gammaproteobacteria_Enterobacteriales_Enterobacteriaceae_Leclercia_adecarboxylata_Leclerc_1783_ATCC_23216, Bacteria_Proteobacteria_Gammaproteobacteria_Enterobacteriales_Enterobacteriaceae_Kluyvera_ascorbata_ATCC_33433, Bacteria_Proteobacteria_Gammaproteobacteria_Enterobacteriales_Enterobacteriaceae_Citrobacter_rodentium_ICC168, Bacteria_Proteobacteria_Gammaproteobacteria_Enterobacteriales_Enterobacteriaceae_Salmonella_enterica_Enterica_sv._Heidelberg_41578, Bacteria_Proteobacteria_Gammaproteobacteria_Enterobacteriales_Enterobacteriaceae_Escherichia_coli_K12__W3110, ...
## 
## Unrooted; includes branch lengths.</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">tree</span><span class="op">$</span><span class="va">tip.label</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">)</span>, scale_by <span class="op">=</span> <span class="st">"curve_length"</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_phylo.html">spiral_phylo</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span>

<span class="va">dend</span> <span class="op">=</span> <span class="fu"><a href="../reference/phylo_to_dendrogram.html">phylo_to_dendrogram</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://talgalili.github.io/dendextend/">dendextend</a></span><span class="op">)</span>
<span class="co"># note for large dendrograms, cutting by height is much more facter than cutting by k</span>
<span class="va">cl</span> <span class="op">=</span> <span class="fu">dendextend</span><span class="fu">::</span><span class="fu"><a href="http://talgalili.github.io/dendextend/reference/cutree-methods.html">cutree</a></span><span class="op">(</span><span class="va">dend</span>, h <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">n_cl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span><span class="op">)</span>
<span class="va">col</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html">structure</a></span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/rand_color.html">rand_color</a></span><span class="op">(</span><span class="va">n_cl</span>, luminosity <span class="op">=</span> <span class="st">"bright"</span>, transparency <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span>
<span class="fu">spiral_rle</span><span class="op">(</span><span class="va">cl</span>, col <span class="op">=</span> <span class="va">col</span><span class="op">)</span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="global-temperature-change" class="section level2">
<h2 class="hasAnchor">
<a href="#global-temperature-change" class="anchor"></a>Global temperature change</h2>
<p>This example visualizes the global temperature change (relative to a base line) since year 1880. The data is download from <a href="https://datahub.io/core/global-temp" class="uri">https://datahub.io/core/global-temp</a>. The temperature data has two sources. In the example code, I use the data from “GCAG”. In the spiral, each loop contains 20 years.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"global_temperature.rds"</span>, package <span class="op">=</span> <span class="st">"spiralize"</span><span class="op">)</span><span class="op">)</span>
<span class="va">df</span> <span class="op">=</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">Source</span> <span class="op">==</span> <span class="st">"GCAG"</span>, <span class="op">]</span>

<span class="fu"><a href="../reference/spiral_initialize_by_time.html">spiral_initialize_by_time</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span>, unit_on_axis <span class="op">=</span> <span class="st">"months"</span>, period <span class="op">=</span> <span class="st">"year"</span>,
    period_per_loop <span class="op">=</span> <span class="fl">20</span>, polar_lines_by <span class="op">=</span> <span class="fl">360</span><span class="op">/</span><span class="fl">20</span>, vp_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">0</span>, <span class="st">"npc"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">lt</span> <span class="op">=</span> <span class="fu"><a href="../reference/spiral_horizon.html">spiral_horizon</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Date</span>, <span class="va">df</span><span class="op">$</span><span class="va">Mean</span>, use_bar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="st">"1880-01-01"</span>, <span class="fl">0.5</span>, <span class="st">"1880"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="st">"1900-01-01"</span>, <span class="fl">0.5</span>, <span class="st">"1900"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="st">"1920-01-01"</span>, <span class="fl">0.5</span>, <span class="st">"1920"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="st">"1940-01-01"</span>, <span class="fl">0.5</span>, <span class="st">"1940"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="st">"1960-01-01"</span>, <span class="fl">0.5</span>, <span class="st">"1960"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="st">"1980-01-01"</span>, <span class="fl">0.5</span>, <span class="st">"1980"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="st">"2000-01-01"</span>, <span class="fl">0.5</span>, <span class="st">"2000"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span>

<span class="va">lgd</span> <span class="op">=</span> <span class="fu"><a href="../reference/horizon_legend.html">horizon_legend</a></span><span class="op">(</span><span class="va">lt</span>, title <span class="op">=</span> <span class="st">"Temperature difference"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html">draw</a></span><span class="op">(</span><span class="va">lgd</span>, x <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">1</span>, <span class="st">"npc"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-11-1.png" width="864" style="display: block; margin: auto;"></p>
</div>
<div id="sunspot-cycle" class="section level2">
<h2 class="hasAnchor">
<a href="#sunspot-cycle" class="anchor"></a>Sunspot cycle</h2>
<p>This example visualizes the sunspot cycles start from year 1749. The activity of sunspot has an average period of 11 years, thus in the spiral, each loop contains 11 years. The data is from <a href="http://sidc.be/silso/datafiles" class="uri">http://sidc.be/silso/datafiles</a> and the plot tries to reproduce <a href="http://www.astrostatistics.org/projects/solar-cycle" class="uri">http://www.astrostatistics.org/projects/solar-cycle</a>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"sunspot.rds"</span>, package <span class="op">=</span> <span class="st">"spiralize"</span><span class="op">)</span><span class="op">)</span>
<span class="va">date</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">year</span>, <span class="va">df</span><span class="op">$</span><span class="va">month</span>, <span class="st">"1"</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="../reference/spiral_initialize_by_time.html">spiral_initialize_by_time</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>, unit_on_axis <span class="op">=</span> <span class="st">"months"</span>, period <span class="op">=</span> <span class="st">"years"</span>, period_per_loop <span class="op">=</span> <span class="fl">11</span>, 
    polar_lines_by <span class="op">=</span> <span class="fl">360</span><span class="op">/</span><span class="fl">11</span>, vp_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">0</span>, <span class="st">"npc"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">col_fun</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">sunspot_number</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">sunspot_number</span><span class="op">)</span>, length <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span>
<span class="va">lt</span> <span class="op">=</span> <span class="fu"><a href="../reference/spiral_horizon.html">spiral_horizon</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">df</span><span class="op">$</span><span class="va">sunspot_number</span>, use_bar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">lgd</span> <span class="op">=</span> <span class="fu"><a href="../reference/horizon_legend.html">horizon_legend</a></span><span class="op">(</span><span class="va">lt</span>, title <span class="op">=</span> <span class="st">"Sunspot count"</span>, format <span class="op">=</span> <span class="st">"%.0f"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html">draw</a></span><span class="op">(</span><span class="va">lgd</span>, x <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">1</span>, <span class="st">"npc"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-12-1.png" width="864" style="display: block; margin: auto;"></p>
</div>
<div id="dna-sequence-alignment" class="section level2">
<h2 class="hasAnchor">
<a href="#dna-sequence-alignment" class="anchor"></a>DNA sequence alignment</h2>
<p>This example visualizes pairwise alignment of CDS (coding sequence) of the gene <em>TP53</em> between human and mouse. The alignment was obtained by <a href="https://blast.ncbi.nlm.nih.gov/Blast.cgi">blast</a>.</p>
<p>First I read the blast result and format it as two vectors of letters.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lines</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"tp53_blast.txt"</span>, package <span class="op">=</span> <span class="st">"spiralize"</span><span class="op">)</span><span class="op">)</span>
<span class="va">query</span> <span class="op">=</span> <span class="va">lines</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">lines</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">]</span>
<span class="va">subject</span> <span class="op">=</span> <span class="va">lines</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">lines</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">]</span>

<span class="va">query</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"^\\S+\\s+\\S+\\s+|\\s+\\S+$"</span>, <span class="st">""</span>, <span class="va">query</span><span class="op">)</span>
<span class="va">query</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">query</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="va">query</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">query</span>, <span class="st">""</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>

<span class="va">subject</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"^\\S+\\s+\\S+\\s+|\\s+\\S+$"</span>, <span class="st">""</span>, <span class="va">subject</span><span class="op">)</span>
<span class="va">subject</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">subject</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="va">subject</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">subject</span>, <span class="st">""</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<p>The plot is mainly drawn with <code><a href="../reference/spiral_text.html">spiral_text()</a></code> and <code><a href="../reference/spiral_segments.html">spiral_segments()</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">query</span><span class="op">)</span>
<span class="va">col</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fl">2</span>, <span class="st">"T"</span> <span class="op">=</span> <span class="fl">4</span>, <span class="st">"C"</span> <span class="op">=</span> <span class="fl">3</span>, <span class="st">"G"</span> <span class="op">=</span> <span class="fl">7</span>, <span class="st">"-"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">)</span>, start <span class="op">=</span> <span class="fl">180</span>, end <span class="op">=</span> <span class="fl">360</span><span class="op">*</span><span class="fl">6</span>, scale_by <span class="op">=</span> <span class="st">"curve"</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span> <span class="op">-</span> <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="va">query</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, 
    gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">6</span>, col <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="va">query</span><span class="op">]</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"top"</span>,<span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span> <span class="op">-</span> <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="va">subject</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, 
    gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">6</span>, col <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="va">subject</span><span class="op">]</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span>
<span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">query</span> <span class="op">==</span> <span class="va">subject</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_segments.html">spiral_segments</a></span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fl">0.5</span>, <span class="fl">0.35</span>, <span class="va">x</span> <span class="op">-</span> <span class="fl">0.5</span>, <span class="fl">0.65</span><span class="op">)</span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-14-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div id="integrative-visualization-of-methylation-and-histone-modifications-for-bcat2" class="section level2">
<h2 class="hasAnchor">
<a href="#integrative-visualization-of-methylation-and-histone-modifications-for-bcat2" class="anchor"></a>Integrative visualization of methylation and histone modifications for BCAT2</h2>
<p>This example visualizes DNA methylation and four histone modification signals along <em>BCAT2</em> gene. The data is from <a href="http://www.roadmapepigenomics.org/">Roadmap project</a>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"BCAT2_tracks.rds"</span>, package <span class="op">=</span> <span class="st">"spiralize"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_initialize_by_gcoor.html">spiral_initialize_by_gcoor</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">df_list</span><span class="op">$</span><span class="va">range</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">df_list</span><span class="op">$</span><span class="va">range</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span>, end <span class="op">=</span> <span class="fl">360</span><span class="op">*</span><span class="fl">3</span>,
    vp_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">0</span>, <span class="st">"npc"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span><span class="op">)</span>

<span class="va">exons</span> <span class="op">=</span> <span class="va">df_list</span><span class="op">$</span><span class="va">exons</span>
<span class="va">exons</span> <span class="op">=</span> <span class="va">exons</span><span class="op">[</span><span class="va">exons</span><span class="op">[</span>, <span class="fl">8</span><span class="op">]</span> <span class="op">==</span> <span class="st">"exon"</span>, <span class="op">]</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.1</span>, background <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_lines.html">spiral_lines</a></span><span class="op">(</span><span class="va">TRACK_META</span><span class="op">$</span><span class="va">xlim</span>, <span class="fl">0.5</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_rect.html">spiral_rect</a></span><span class="op">(</span><span class="va">exons</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="fl">0.1</span>, <span class="va">exons</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>, <span class="fl">0.9</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_segments.html">spiral_segments</a></span><span class="op">(</span><span class="fl">49314320</span>, <span class="fl">0</span>, <span class="fl">49314320</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_segments.html">spiral_segments</a></span><span class="op">(</span><span class="fl">49314320</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">49314320</span> <span class="op">-</span> <span class="fl">200</span>, <span class="op">-</span><span class="fl">1</span>, arrow <span class="op">=</span> <span class="fu">arrow</span><span class="op">(</span>length <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49314320</span>, <span class="op">-</span><span class="fl">1</span>, <span class="st">"TSS"</span>, hjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.2</span>, facing <span class="op">=</span> <span class="st">"outside"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="../reference/spiral_segments.html">spiral_segments</a></span><span class="op">(</span><span class="fl">49298321</span>, <span class="fl">0</span>, <span class="fl">49298321</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49298321</span>, <span class="op">-</span><span class="fl">1</span>, <span class="st">"TES"</span>, hjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.2</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_points.html">spiral_points</a></span><span class="op">(</span><span class="fl">49298321</span>, <span class="op">-</span><span class="fl">1</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>

<span class="va">meth</span> <span class="op">=</span> <span class="va">df_list</span><span class="op">$</span><span class="va">meth</span>
<span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="va">meth_col</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_segments.html">spiral_segments</a></span><span class="op">(</span><span class="va">meth</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="fl">0</span>, <span class="va">meth</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>col <span class="op">=</span> <span class="fu">meth_col</span><span class="op">(</span><span class="va">meth</span><span class="op">[</span>, <span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">lgd_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Legend.html">Legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Methylation"</span>, col_fun <span class="op">=</span> <span class="va">meth_col</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">i</span> <span class="op">=</span> <span class="fl">1</span>
<span class="kw">for</span><span class="op">(</span><span class="va">mark</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"H3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df_list</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">df</span> <span class="op">=</span> <span class="va">df_list</span><span class="op">[[</span><span class="va">mark</span><span class="op">]</span><span class="op">]</span>
    <span class="va">i</span> <span class="op">=</span> <span class="va">i</span> <span class="op">+</span> <span class="fl">1</span>
    <span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
    <span class="va">lt</span> <span class="op">=</span> <span class="fu"><a href="../reference/spiral_horizon.html">spiral_horizon</a></span><span class="op">(</span> <span class="op">(</span><span class="va">df</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">df</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="va">df</span><span class="op">[</span>, <span class="fl">5</span><span class="op">]</span>, pos_fill <span class="op">=</span> <span class="va">i</span>,
        use_bars <span class="op">=</span> <span class="cn">TRUE</span>, bar_width <span class="op">=</span> <span class="va">df</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">df</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>
    <span class="va">lgd_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">lgd_list</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/horizon_legend.html">horizon_legend</a></span><span class="op">(</span><span class="va">lt</span>, title <span class="op">=</span> <span class="va">mark</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="../reference/spiral_lines.html">spiral_lines</a></span><span class="op">(</span><span class="va">TRACK_META</span><span class="op">$</span><span class="va">xlim</span>, <span class="fl">1</span><span class="op">)</span>
<span class="va">at</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">df_list</span><span class="op">$</span><span class="va">range</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">]</span>, <span class="va">df_list</span><span class="op">$</span><span class="va">range</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">1000</span><span class="op">)</span>
<span class="va">labels</span> <span class="op">=</span> <span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">df_list</span><span class="op">$</span><span class="va">range</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">]</span>, <span class="va">df_list</span><span class="op">$</span><span class="va">range</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">1000</span><span class="op">)</span> <span class="op">-</span> <span class="fl">49314320</span><span class="op">)</span>
<span class="va">labels</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">labels</span><span class="op">/</span><span class="fl">1000</span>, <span class="st">"KB"</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_axis.html">spiral_axis</a></span><span class="op">(</span>at <span class="op">=</span> <span class="va">at</span>, labels <span class="op">=</span> <span class="va">labels</span><span class="op">)</span>

<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49297321</span>, <span class="fl">0.5</span>, <span class="st">"Methylation"</span>, hjust <span class="op">=</span> <span class="fl">0</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>, track_index <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49297321</span>, <span class="fl">0.5</span>, <span class="st">"H3K4me1"</span>, hjust <span class="op">=</span> <span class="fl">0</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>, track_index <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49297321</span>, <span class="fl">0.5</span>, <span class="st">"H3K4me3"</span>, hjust <span class="op">=</span> <span class="fl">0</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>, track_index <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49297321</span>, <span class="fl">0.5</span>, <span class="st">"H3K9me3"</span>, hjust <span class="op">=</span> <span class="fl">0</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>, track_index <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49297321</span>, <span class="fl">0.5</span>, <span class="st">"H3K27ac"</span>, hjust <span class="op">=</span> <span class="fl">0</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>, track_index <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>

<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49315320</span>, <span class="fl">0.5</span>, <span class="st">"Methylation"</span>, hjust <span class="op">=</span> <span class="fl">1</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>, track_index <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49315320</span>, <span class="fl">0.5</span>, <span class="st">"H3K4me1"</span>, hjust <span class="op">=</span> <span class="fl">1</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>, track_index <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49315320</span>, <span class="fl">0.5</span>, <span class="st">"H3K4me3"</span>, hjust <span class="op">=</span> <span class="fl">1</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>, track_index <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49315320</span>, <span class="fl">0.5</span>, <span class="st">"H3K9me3"</span>, hjust <span class="op">=</span> <span class="fl">1</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>, track_index <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49315320</span>, <span class="fl">0.5</span>, <span class="st">"H3K27ac"</span>, hjust <span class="op">=</span> <span class="fl">1</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>, track_index <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>

<span class="va">lgd</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/packLegend.html">packLegend</a></span><span class="op">(</span>list <span class="op">=</span> <span class="va">lgd_list</span>, max_height <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">8</span>, <span class="st">"in"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html">draw</a></span><span class="op">(</span><span class="va">lgd</span>, x <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">1</span>, <span class="st">"npc"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-15-1.png" width="960" style="display: block; margin: auto;"></p>
<script src="jquery.min.js"></script><script src="jquery.sticky.js"></script><script>
$(document).ready(function(){
    $("#TOC").sticky({
        topSpacing: 0,
        zIndex:1000    
    })
    $("#TOC").on("sticky-start", function() {

        $("<p style='font-size:1.2em; padding-left:4px;'><a id='TOC-click'>Table of Content</a></p>").insertBefore($("#TOC ul:first-child"));
        $("#TOC-click").hover(function() {
            $(this).css("color", "#0033dd").css("cursor", "pointer");
            $("#TOC").children().first().next().show();
            $("#TOC").hover(function() {
                $(this).children().first().next().show();
            }, function() {
                $(this).children().first().next().hide();
                $("body").off("hover", "#TOC");
            })
        }, function() {
            $(this).css("color", "#0033dd");
        })
        $("#TOC").children().first().next().hide();

    })
    $("#TOC").on("sticky-end", function() {
        $("#TOC").children().first().remove();
        $("#TOC").children().first().show();
    })
});
</script>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
